{
  "version": 3,
  "sources": ["../../src/pylontech/FktInOrder.ts"],
  "sourcesContent": ["// Copyright (c) 2020-2023 Tr\u00E4ger\r\n\r\n// Permission is hereby granted, free of charge, to any person obtaining a\r\n// copy of this software and associated documentation files (the \"Software\"),\r\n// to deal in the Software without restriction, including without limitation\r\n// the rights to use, copy, modify, merge, publish, distribute, sublicense,\r\n// and/or sell copies of the Software, and to permit persons to whom the\r\n// Software is furnished to do so, subject to the following conditions:\r\n\r\n// The above copyright notice and this permission notice shall be included in\r\n// all copies or substantial portions of the Software.\r\n\r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\r\n// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\r\n// DEALINGS IN THE SOFTWARE.\r\n\r\nexport class FktInOrder {\r\n  protected _list: ((resolve: (value: void | PromiseLike<void>) => void, reject: (reason?: any) => void) => void)[] = [];\r\n  protected _busy: boolean = false;\r\n  protected _timer: NodeJS.Timeout | undefined;\r\n  protected _errLog: (msg: string) => void;\r\n\r\n  constructor(errLog: (msg: string) => void) {\r\n    this._errLog = errLog;\r\n  }\r\n\r\n  addFunc(func: (resolve: (value: void | PromiseLike<void>) => void, reject: (reason?: any) => void) => void): void {\r\n    if (func) {\r\n      this._list.push(func);\r\n      this.donext();\r\n    }\r\n  }\r\n\r\n  doende(): void {\r\n    this._busy = false;\r\n    clearTimeout(this._timer);\r\n    this.donext();\r\n  }\r\n  donext(): void {\r\n    if (!this._busy) {\r\n      this._busy = true;\r\n      const func: ((resolve: (value: void | PromiseLike<void>) => void, reject: (reason?: any) => void) => void) | undefined = this._list.pop();\r\n      if (func) {\r\n        new Promise<void>((resolve, reject) => {\r\n          this._timer = setTimeout((): void => {\r\n            this.doende();\r\n            reject('order timeout!!!');\r\n          }, 30000);\r\n\r\n          const resolveInt = (): void => {\r\n            this.doende();\r\n            resolve();\r\n          };\r\n          const rejectInt = (err: string): void => {\r\n            this.doende();\r\n            reject(err);\r\n          };\r\n          func(resolveInt, rejectInt);\r\n        }).catch(this._errLog);\r\n      } else {\r\n        this._busy = false;\r\n      }\r\n    }\r\n  }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAoBO,MAAM,WAAW;AAAA,EAMtB,YAAY,QAA+B;AAL3C,SAAU,QAA0G,CAAC;AACrH,SAAU,QAAiB;AAKzB,SAAK,UAAU;AAAA,EACjB;AAAA,EAEA,QAAQ,MAA0G;AAChH,QAAI,MAAM;AACR,WAAK,MAAM,KAAK,IAAI;AACpB,WAAK,OAAO;AAAA,IACd;AAAA,EACF;AAAA,EAEA,SAAe;AACb,SAAK,QAAQ;AACb,iBAAa,KAAK,MAAM;AACxB,SAAK,OAAO;AAAA,EACd;AAAA,EACA,SAAe;AACb,QAAI,CAAC,KAAK,OAAO;AACf,WAAK,QAAQ;AACb,YAAM,OAAmH,KAAK,MAAM,IAAI;AACxI,UAAI,MAAM;AACR,YAAI,QAAc,CAAC,SAAS,WAAW;AACrC,eAAK,SAAS,WAAW,MAAY;AACnC,iBAAK,OAAO;AACZ,mBAAO,kBAAkB;AAAA,UAC3B,GAAG,GAAK;AAER,gBAAM,aAAa,MAAY;AAC7B,iBAAK,OAAO;AACZ,oBAAQ;AAAA,UACV;AACA,gBAAM,YAAY,CAAC,QAAsB;AACvC,iBAAK,OAAO;AACZ,mBAAO,GAAG;AAAA,UACZ;AACA,eAAK,YAAY,SAAS;AAAA,QAC5B,CAAC,EAAE,MAAM,KAAK,OAAO;AAAA,MACvB,OAAO;AACL,aAAK,QAAQ;AAAA,MACf;AAAA,IACF;AAAA,EACF;AACF;",
  "names": []
}
